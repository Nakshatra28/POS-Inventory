<!-- Header -->
<div class="flex justify-between items-center px-6">
  <div>
   <p class="text-xl md:text-3xl font-semibold">Stock Movements</p>

    <p class="text-xs text-gray-500 px-1">
      Track all inventory movements and adjustments </p>
  </div>
</div>


<!-- stocks -->

<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 px-6 mt-4">


  <div class=" rounded-lg bg-gray-800/80 backdrop-blur-xl w-full p-3 m-2 p-2">
    <div class="flex justify-between">
      <p class="text-sm">Stock In (Today)</p>
      <p class="bg-red-400/40  flex justify-center items-center size-8 rounded-lg text-red-500 "><svg
          class="text-green-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" class="size-4 font-bolder">
          <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3" />
        </svg>

    </div>
    <p class="text-xl py-1">{{ summary.stockInToday }}</p>

  </div>




  <div class="rounded-lg bg-gray-800/80 backdrop-blur-xl   w-full p-3 m-2">
    <div class="flex justify-between">
      <p class="text-sm">Stock Out (Today) </p>
      <p class="bg-green-400/40 text-green-400  flex justify-center items-center size-8 rounded-lg "><svg
          xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
          class="size-4">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18" />
        </svg>

      </p>
    </div>
    <p class="text-xl py-1">{{ summary.stockOutToday }}</p>


  </div>





  <div class="rounded-lg bg-gray-800/80 backdrop-blur-xl  w-full p-3 m-2 ">
    <div class="flex justify-between">
      <p class="text-sm">Pending Stock </p>
      <p class="bg-orange-400  flex justify-center items-center size-8 rounded-lg ">
        <i class="fa-solid fa-exclamation" style="color: #ffffff;"></i>
      </p>
    </div>
    <p class="text-xl py-1">{{ summary.pendingStock }}</p>


  </div>





  <div class="rounded-lg bg-gray-800/80 backdrop-blur-xl  w-full p-3 m-2 ">
    <div class="flex justify-between">
      <p class="text-sm">Adjustments (Today) </p>
      <p class="bg-blue-400  flex justify-center items-center size-8 rounded-lg "><i class="fa-solid fa-user-group"
          style="color: #fcfcfc;"></i>
      </p>
    </div>
    <p class="text-xl py-1">{{ summary.adjustmentsToday }}</p>


  </div>

</div>


<!-- Search + Filter Row -->
<div class="flex flex-col md:flex-row gap-3 px-6 mt-6 mb-8">

  <!-- Search -->
  <div>
    <div class="flex items-center border border-white/20 w-full md:w-64 py-0.5 rounded-lg px-2">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
        class="size-5">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
      </svg>
      <input type="search" placeholder="Search" [(ngModel)]="searchText" (input)="applySearch()"
        class="px-2 bg-transparent outline-none" />
    </div>
  </div>

  <!-- Filter -->
  <div>
    <button class="flex items-center gap-1 bg-gray-700 rounded-lg px-3 py-0.5">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
        class="size-4">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z" />
      </svg>
      <p>Filter</p>
    </button>
  </div>


  <button
  (click)="openAdjustmentPopup = true"
class="w-full md:w-auto px-4 py-2 bg-blue-600 text-white rounded-lg text-sm"
>
  + Adjust Stock
</button>
</div>




<!-- ..... -->


<div>
  <div class="px-6 ">
    <div class="overflow-x-auto rounded-lg border border-white/10">
      <table class="w-full text-left text-sm">

        <!-- Table Head -->
        <thead class="bg-gray-800 text-gray-300">
          <tr>

            <th class="py-3 px-4">Sr No</th>
            <th class="py-3 px-4"> Date</th>
            <th class="py-3 px-4">Type</th>
            <th class="py-3 px-4">Product</th>
            <th class="py-3 px-4">Quantity</th>
            <th class="py-3 px-4">Reffernce</th>
            <th class="py-3 px-4">user</th>
            <th class="py-3 px-4 text-right">Actions</th>
          </tr>
        </thead>

        <!-- Table Body -->
        <tbody class="text-gray-200 bg-[#0F172B]">

          <tr *ngFor="let m of filteredMovements; let i = index"
            class="border-t border-white/10 hover:bg-white/5 transition">
            <td class="py-3 px-4">{{ i + 1 }}</td>
            <td class="py-3 px-4">{{ m.createdAt | date:'short' }}</td>

            <td class="py-3 px-4">
              <span class="px-2 py-1 text-xs rounded" [ngClass]="{
        'bg-green-600/20 text-green-400': m.type === 'IN',
        'bg-red-600/20 text-red-400': m.type === 'OUT',
        'bg-blue-600/20 text-blue-400': m.type === 'ADJUST'
      }">
                {{ m.type }}
              </span>
            </td>

            <td class="py-3 px-4">{{ m.productName }}</td>
            <td class="py-3 px-4">{{ m.quantity }}</td>
            <td class="py-3 px-4">{{ m.referenceId }}</td>
            <td class="py-3 px-4">{{ m.user }}</td>

            <td class="py-3 px-4 text-right">
            <button
class="text-blue-400 text-sm px-2 py-1 rounded hover:bg-white/10"
  (click)="viewMovement(m)"
>
  View
</button>
            </td>
          </tr>








        </tbody>

      </table>
    </div>
  </div>


</div>

<app-stock-adjustment-popup
  *ngIf="openAdjustmentPopup"
  (close)="openAdjustmentPopup = false"
  (success)="onAdjustmentSuccess()"
  (toast)="openToast($event)"
></app-stock-adjustment-popup>


<div
  *ngIf="toastVisible"
  class="fixed bottom-6 right-6 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg z-[9999]"
>
  {{ toastMessage }}
</div>